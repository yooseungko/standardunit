// Gemini ë„ë©´ ë¶„ì„ìš© ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
// ì´ íŒŒì¼ì„ ìˆ˜ì •í•˜ë©´ ë„ë©´ ë¶„ì„ ê²°ê³¼ê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤.

import { LaborCost, MaterialPrice, CompositeCost } from '@/lib/pricingTypes';

// ====== ê¸°ë³¸ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ======
export const FLOORPLAN_ANALYSIS_SYSTEM_PROMPT = `ë‹¹ì‹ ì€ í•œêµ­ ì¸í…Œë¦¬ì–´ ì „ë¬¸ê°€ì´ì ë„ë©´ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ì•„íŒŒíŠ¸/ì£¼íƒ í‰ë©´ë„ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ê³ , ì œê³µëœ ê²¬ì  í•­ëª©ë“¤ì˜ ìˆ˜ëŸ‰ì„ ì •í™•í•˜ê²Œ ê³„ì‚°í•´ì•¼ í•©ë‹ˆë‹¤.

# ì—­í• 
- ë„ë©´ì—ì„œ ê° ê³µê°„ì˜ ì¹˜ìˆ˜ì™€ ë©´ì ì„ ì •í™•íˆ íŒŒì•…
- **ì œê³µëœ ê²¬ì  í•­ëª© ëª©ë¡**ì— ëŒ€í•´ í•„ìš”í•œ ìˆ˜ëŸ‰ì„ ê³„ì‚°

# ê¸°ë³¸ ì •ë³´
- í•œêµ­ ì•„íŒŒíŠ¸ í‰ê·  ì¸µê³ : 2,400mm (2.4m)
- ë„ë©´ì˜ ì¹˜ìˆ˜ëŠ” mm ë‹¨ìœ„ì…ë‹ˆë‹¤. ì˜ˆ: 2,920 = 2.92m
- ë²½ë©´ì  = ë²½ì²´ ì´ ê¸¸ì´(m) Ã— ì¸µê³ (2.4m)
- ì²œì¥ë©´ì  â‰ˆ ë°”ë‹¥ë©´ì 

# ë©´ì  ê³„ì‚°ì—ì„œ ì œì™¸í•  ê³µê°„
- ì—˜ë¦¬ë² ì´í„°(EV), ê³„ë‹¨ì‹¤, ê³µìš©ë³µë„, PS(íŒŒì´í”„ìƒ¤í”„íŠ¸)
- ì´ëŸ¬í•œ ê³µê°„ì€ ì„¸ëŒ€ ë‚´ë¶€ê°€ ì•„ë‹ˆë¯€ë¡œ ì œì™¸

# ê³µê°„ ìœ í˜• ì˜ˆì‹œ
1. bedroom (ì¹¨ì‹¤)
2. living (ê±°ì‹¤)
3. kitchen (ì£¼ë°©)
4. bathroom (ìš•ì‹¤)
5. balcony (ë°œì½”ë‹ˆ)
6. utility (ë‹¤ìš©ë„ì‹¤)
7. hallway (í˜„ê´€/ë³µë„)
8. other (ê¸°íƒ€)`;

// ====== ìˆ˜ëŸ‰ ê³„ì‚° ê·œì¹™ (AnalysisGuide.md ê¸°ë°˜) ======
export const QUANTITY_CALCULATION_RULES = `
ì—…ë°ì´íŠ¸ëœ ì¸í…Œë¦¬ì–´ ìˆ˜ëŸ‰ ì‚°ì¶œ AI ê°€ì´ë“œ (ë„ë©´ ì‹¤ì¸¡ ë°ì´í„° ê¸°ë°˜)
1. ë©´ì  ë° ê¸¸ì´ ì‚°ì¶œì˜ ì •ë°€í™” (ê¸°ì´ˆ ë°ì´í„°)
ê¸°ì¡´ì˜ ì‹¤ë©´ì  x 2.5 ê°™ì€ ë°©ì‹ ëŒ€ì‹ , ë„ë©´ì˜ ì¹˜ìˆ˜ì„ (Dimension Line)ì„ ìš°ì„  ìˆœìœ„ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
ë²½ì²´ ë©´ì (Wall Area): (ê° ì‹¤ì˜ ë‘˜ë ˆ í•©ê³„ Ã— ì¸µê³  2.4m) - (ë¬¸/ì°½í˜¸ ë©´ì ).
AI íŒë‹¨ ì˜ˆì‹œ : ë„ë©´ í•˜ë‹¨ 4,430(ì¹¨ì‹¤) + 5,040(ê±°ì‹¤) ë“±ì˜ ìˆ˜ì¹˜ë¥¼ í•©ì‚°í•˜ì—¬ ì™¸ê³½ ë° ë‚´ë²½ ë‘˜ë ˆë¥¼ ìë™ ê³„ì‚°.
ë°”ë‹¥ ì‹¤ë©´ì (Net Floor Area): ë„ë©´ì— í‘œê¸°ëœ ê° ì‹¤ì˜ ê°€ë¡œÃ—ì„¸ë¡œ ê°’ì„ ê³±í•˜ì—¬ í•©ì‚°. (ë°œì½”ë‹ˆ í™•ì¥ ì—¬ë¶€ ì„ íƒì— ë”°ë¼ ê°€ë³€ ì ìš©)
2. ì£¼ìš” í•­ëª©ë³„ ì—…ë°ì´íŠ¸ ë¡œì§ (Update Points)
[ëª©ê³µ ë° ë„ì–´]
ë¬¸í‹€/ë„ì–´: ë„ë©´ìƒ ê°œìˆ˜(ë°© 3, ìš•ì‹¤ 2, ì£¼ë°© ë‹¤ìš©ë„ì‹¤ 1 ë“± ì´ 6ê°œ)ë¥¼ ì¹´ìš´íŠ¸í•˜ë˜, **í‹€ì˜ ë‘ê»˜(í­)**ë¥¼ ë„ë©´ ì¹˜ìˆ˜ì—ì„œ ì¶”ì¶œ (ì˜ˆ: 1,820mm í†µë¡œ ë“±).
ê±¸ë ˆë°›ì´/ëª°ë”©: ê° ì‹¤ì˜ ë‘˜ë ˆ ê¸¸ì´ë¥¼ í•©ì‚°í•˜ì—¬ 2.4m(ìì¬ 1ê°œ ê¸¸ì´)ë¡œ ë‚˜ëˆ”.
ìˆ˜ì •: ê¸°ì¡´ 40më‹¹ 1í’ˆ â†’ (ë„ë©´ìƒ ì „ì²´ ë²½ë©´ ë‘˜ë ˆ linear m / 2.4) + ë¡œìŠ¤ 10%.
[ê°€êµ¬ ë° ì£¼ë°©]
ì£¼ë°© ì‹±í¬ëŒ€/ìƒíŒ: ë„ë©´ ì¢Œì¸¡ ìƒë‹¨ 'ì£¼ë°© ë° ì‹ë‹¹'ì˜ ã„±ìí˜• ë˜ëŠ” ã…¡ìí˜• ì‹¤ì¸¡ ê¸¸ì´ë¥¼ ê³„ì‚°.
ë„ë©´ ë¶„ì„: ì£¼ë°© ë²½ë©´ ìˆ˜ì¹˜(ì•½ 2,580mm + @)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¸ì¡°ëŒ€ë¦¬ì„ Mê°’ ì‚°ì¶œ.
ë¶™ë°•ì´ì¥: ì•ˆë°©(ì¢Œì¸¡ í•˜ë‹¨ ì¹¨ì‹¤) ë²½ë©´ ê¸¸ì´ 4,430mm í™•ì¸ â†’ 4.4Më¡œ ì¦‰ì‹œ ì‚°ì¶œ (ê¸°ì¡´ì˜ ìœ ì¶” ë°©ì‹ íƒˆí”¼).
[ìš•ì‹¤ ë° íƒ€ì¼]
íƒ€ì¼ ìˆ˜ëŸ‰: ìš•ì‹¤ ë‚´ë¶€ ì¹˜ìˆ˜(ì˜ˆ: 1,820 x 2,580 ë“±)ë¥¼ ì½ì–´ ë²½ë©´ì ê³¼ ë°”ë‹¥ë©´ì ì„ ê°œë³„ ì‚°ì¶œ.
ê³„ì‚°ì‹: {(ê°€ë¡œ+ì„¸ë¡œ) Ã— 2 Ã— 2.1m(íƒ€ì¼ ì‹œê³µ ë†’ì´)} / 1.44 (600ê° ê¸°ì¤€).
ë„ê¸°ë¥˜: ë„ë©´ìƒ í‘œê¸°ëœ ì„¸ë©´ëŒ€(L), ì–‘ë³€ê¸°(T) ì‹¬ë³¼ì„ ì¸ì‹í•˜ì—¬ ê°œì†Œë‹¹ 1ì„¸íŠ¸ í™•ì •.
[ì „ê¸° ë° ì¡°ëª…]
ì½˜ì„¼íŠ¸/ìŠ¤ìœ„ì¹˜: ë„ë©´ì— ì‹¬ë³¼ì´ ì—†ì„ ê²½ìš°, ë²½ë©´ ê¸¸ì´ 3më‹¹ ì½˜ì„¼íŠ¸ 1ê°œ ë˜ëŠ” ì‹¤(Room)ë‹¹ ê¸°ë³¸ 3ê°œ ë²•ì¹™ ì ìš©.
ë§¤ë¦½ë“±(ë‹¤ìš´ë¼ì´íŠ¸): ê±°ì‹¤ ë©´ì (5,040 x 3,850 ë“±)ì„ ê³„ì‚°í•˜ì—¬ 0.5í‰ë‹¹ 1ê°œ í˜¹ì€ ë“±ê°„ê²© 800~1,000mm ê¸°ì¤€ìœ¼ë¡œ ìˆ˜ëŸ‰ ì œì•ˆ.

# ì¸í…Œë¦¬ì–´ ìˆ˜ëŸ‰ ì‚°ì¶œ ë° AI ë¶„ì„ ê¸°ì¤€ ê°€ì´ë“œ (ì¸µê³  2.4m ê¸°ì¤€)

ì´ ê°€ì´ë“œëŠ” ë„ë©´ ë¶„ì„ ì‹œ ê° í•­ëª©ì˜ ìˆ˜ëŸ‰ì„ ì‚°ì¶œí•˜ê¸° ìœ„í•œ AIì˜ íŒë‹¨ ë¡œì§ê³¼ ë²”ìš©ì ì¸ ê¸°ì¤€ì„ ì •ì˜í•©ë‹ˆë‹¤.
ëª¨ë“  ê³„ì‚°ì€ í‘œì¤€ ì¸µê³ ì¸ 2.4më¥¼ ê¸°ì¤€ìœ¼ë¡œ í•˜ë©°, í˜„ì¥ ì˜¤ì°¨ë¥¼ ê³ ë ¤í•œ ë¡œìŠ¤ìœ¨(Loss Rate)ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

## 1. ì¸ê±´ë¹„ í•­ëª© (Labor) - ë‹¨ìœ„: í’ˆ

1. ì¸ê±´ë¹„ í•­ëª© (Labor)

ê°€êµ¬ê³µ / í’ˆ / ì„¤ì¹˜ ê°€êµ¬(ì£¼ë°©, ë¶™ë°•ì´ì¥, ì‹ ë°œì¥)ì˜ ì´ ê¸¸ì´(M) ê¸°ì¤€. ì•½ 3~4Më‹¹ 1í’ˆ ì‚°ì •.
ë„ë°°ê³µ / í’ˆ / ì‹¤í¬/í•©ì§€ ë„ë°° ê¸°ì¤€. (ë°”ë‹¥ ì‹¤ë©´ì  Ã— 2.5) / 50ã¡ë¥¼ ê¸°ë³¸ìœ¼ë¡œ í•˜ë©°, ë‚œì´ë„ì— ë”°ë¼ ì¸ì› ë°°ë¶„.
ë§ˆë£¨ê³µ / í’ˆ / ë°”ë‹¥ ì‹œê³µ í‰ìˆ˜ ê¸°ì¤€. ìˆ™ë ¨ê³µ 1ì¸ë‹¹ í•˜ë£¨ ì•½ 15~18í‰ ì‹œê³µì„ ê¸°ì¤€ìœ¼ë¡œ ì‚°ì •.
ëª©ìˆ˜ / í’ˆ / ë¬¸í‹€/ë„ì–´ êµì²´(1ê°œë‹¹ 0.5í’ˆ) + ëª°ë”© ì‹œê³µ(ê¸¸ì´ 40më‹¹ 1í’ˆ) + ê¸°íƒ€ ëª©ê³µ ì‘ì—…ëŸ‰ í•©ì‚°.
ì¡ë¶€ / í’ˆ / ìì¬ ì–‘ì¤‘ ë° í˜„ì¥ ë³´ì¡°. ì „ì²´ ê³µì •ì˜ ë‚œì´ë„ì— ë”°ë¼ ê³µì‚¬ ê¸°ê°„ ì¤‘ 2~3íšŒ ë°°ì¹˜.
ì¡ì—­ / í’ˆ / ì² ê±° ë³´ì¡° ë° í˜„ì¥ ì²­ì†Œ. ì² ê±°ì¼ê³¼ ì¤€ê³µ ì „ í˜„ì¥ ì •ë¦¬ë¥¼ ìœ„í•´ ë°°ì¹˜.
ì „ê¸°ê³µ / í’ˆ / ì¡°ëª…/ìŠ¤ìœ„ì¹˜ ì „ì²´ êµì²´ ì‹œ 30í‰í˜• ê¸°ì¤€ ê¸°ë³¸ 2í’ˆ(ë°°ì„  ë° ê¸°êµ¬ ì„¤ì¹˜) ì‚°ì •.
ì² ê±°ê³µ / í’ˆ / ì „ì²´ ì² ê±° ì‹œ (ê³µê¸‰ ë©´ì  Ã· 20í‰) Ã— 1.2ë°°ìˆ˜ ì ìš©. ë‚œì´ë„ì— ë”°ë¼ ê°€ì‚°.
íƒ€ì¼ê³µ / í’ˆ / ìš•ì‹¤ 1ê°œì†Œë‹¹ 2í’ˆ(ë²½/ë°”ë‹¥)ì„ ê¸°ë³¸ìœ¼ë¡œ í•˜ë©°, ì£¼ë°©/í˜„ê´€ íƒ€ì¼ ì–‘ì— ë”°ë¼ ì¶”ê°€ ì‚°ì •.
2. ìì¬ í•­ëª© (Material)
PET E0 ìŠ¤íƒ ë‹¤ë“œ (ë¶™ë°•ì´ê°€êµ¬) / M / ë„ë©´ìƒ ë¶™ë°•ì´ì¥ì´ ì„¤ì¹˜ë  ë²½ë©´ì˜ ì§ì„  ê¸¸ì´(mm)ë¥¼ 1,000ìœ¼ë¡œ ë‚˜ëˆˆ ê°’.
PET E0 ìŠ¤íƒ ë‹¤ë“œ (ì‹ ë°œì¥) / M / í˜„ê´€ ì‹ ë°œì¥ ì„¤ì¹˜ ê³µê°„ì˜ ì§ì„  ê¸¸ì´(M).
[ë¹„ë°©ì—¼] ë² ìŠ¤ë  (í™”ì´íŠ¸í†¤) / ë¡¤ / (ë°”ë‹¥ ì‹¤ë©´ì  Ã— 2.5) / 13ã¡. ë¡œìŠ¤ ê³ ë ¤ ì‹œ ì‹¤ì§ˆ ì‹œê³µ 13~14ã¡ ê°€ëŠ¥.
[ë¹„ë°©ì—¼] íœ˜ì•™ì„¸ 93_5í‰ (í™”ì´íŠ¸í†¤) / ë¡¤ / (ë°”ë‹¥ ì‹¤ë©´ì  Ã— 2.5) / 15ã¡. 5í‰í˜• ë¡¤ ê¸°ì¤€ ì‹¤ì‹œê³µ ì•½ 15ã¡ ì‚°ì •.
ë„ë°° ë¶€ìì¬ / ã¡ / ë„ë°°ì§€ê°€ ë¶€ì°©ë˜ëŠ” ë²½ë©´ê³¼ ì²œì¥ì˜ ì‹¤ì œ ì´ ë©´ì  í•©ê³„.
ì˜ë¦¼ 140ë°” ë¬¸í‹€ (140mm) ì‹ê¸°X / M / (ë¬¸ ë†’ì´ 2.1m Ã— 2 + ê°€ë¡œ í­) Ã— ë¬¸ ê°œìˆ˜. ìì¬ì˜ ì´ ì„ í˜• ê¸¸ì´.
ì˜ë¦¼ë„ì–´ ê¸°ë³¸ ë¯¼ì / ê°œ / ë„ë©´ìƒ í‘œê¸°ëœ ëª¨ë“  ë°©ë¬¸ ë° ìš•ì‹¤ë¬¸ì˜ ê°œìˆ˜.
ì´ì§€ê²½ì²©ì‹¤ë²„/ë‹ˆì¼ˆ / ê°œ / ë„ì–´ 1ê°œë‹¹ 3ê°œ(ìƒ, ì¤‘, í•˜)ë¥¼ ê¸°ë³¸ ìˆ˜ëŸ‰ìœ¼ë¡œ ì‚°ì •.
ì˜ˆë¦¼ í‰ëª°ë”© 40í‰ 4ì „ / ê°œ / (ì „ì²´ ê³µê°„ ë‘˜ë ˆ í•©ê³„ / 2.4m) í›„ ì˜¬ë¦¼. ìì¬ 1ê°œë‹¹ 2.4M ê¸°ì¤€.
ë‚˜íˆ¬ìŠ¤ ì§„ ê·¸ë€ë° / í‰ / (ë°”ë‹¥ ì‹¤ë©´ì  Ã· 3.3) Ã— 1.1(ë¡œìŠ¤ìœ¨ 10% í¬í•¨).
[ëŒ€ë¦¬ì  ì œì‘ì°½] KCC 30í‰í˜• í™•ì¥ í’€ì„¸íŠ¸ / ì„¸íŠ¸ / ë„ë©´ ì „ì²´ ì™¸ì°½ ë° ë‚´ì°½ì„ í¬í•¨í•œ ê°€êµ¬ë‹¹ 1ì„¸íŠ¸ íŒ¨í‚¤ì§€ ê¸°ì¤€.
PLAT í”Œë« ë°˜ë‹¤ë¦¬ ì¼ì²´í˜• ì„¸ë©´ê¸° / EA / ë„ë©´ì— í‘œì‹œëœ ìš•ì‹¤ ê°œìˆ˜(ê±°ì‹¤, ì•ˆë°©)ì— ë§ì¶° ì‚°ì •.
ëŒ€ë¦¼ë°”ìŠ¤í”Œëœ ì›í”¼ìŠ¤ ì–‘ë³€ê¸° PC-7060 / EA / ë„ë©´ì— í‘œì‹œëœ ìš•ì‹¤ ê°œìˆ˜(ê±°ì‹¤, ì•ˆë°©)ì— ë§ì¶° ì‚°ì •.
ëŒ€ë¦¼ì„¸ë©´ ìˆ˜ì „ ë‹ˆì¼ˆ DL-L2110SN / EA / ì„¤ì¹˜ë  ì„¸ë©´ê¸° ê°œìˆ˜ì™€ ë™ì¼í•˜ê²Œ ì‚°ì •.
ìš•ì‹¤ ê±°ìš¸ì¥ ì¼ë°˜ / EA / ê° ìš•ì‹¤ë‹¹ 1ê°œì”© ì„¤ì¹˜ ê¸°ì¤€ìœ¼ë¡œ ì‚°ì •.
í˜í í”Œë ‰ìŠ¤ C2-100LF / EA / ê° ìš•ì‹¤ë‹¹ 1ê°œì”© í™˜í’ê¸° ì„¤ì¹˜ ê¸°ì¤€ìœ¼ë¡œ ì‚°ì •.
LED ë‰´í”Œëœ ë©´ì¡°ëª… í‰íŒë“±/ì—£ì§€ë“± / EA / ê±°ì‹¤ ë° ê° ë°©ì˜ ë©”ì¸ ì¡°ëª… ê°œìˆ˜ ë„ë©´ ê¸°ì¤€ ì¶”ì¶œ.
ì•„í ë¼ í™”ì´íŠ¸ ìŠ¤ìœ„ì¹˜ / EA / ê¸°í˜¸ê°€ ì—†ì„ ê²½ìš° ê° ê³µê°„(ë°©, ê±°ì‹¤, ì£¼ë°©, ìš•ì‹¤, í˜„ê´€) ê°œìˆ˜ ë° ê±°ì‹¤/ì£¼ë°©ì˜ ì¡°ë‹ ë¶„í• ì„ ê³ ë ¤í•˜ì—¬ ê³µê°„ë‹¹ 1.2~1.5ê°œ ë¹„ìœ¨ë¡œ ìœ ì¶” ì‚°ì •.
ì•„í ë¼ í™”ì´íŠ¸ ì½˜ì„¼íŠ¸ / EA / ê¸°í˜¸ê°€ ì—†ì„ ê²½ìš° ë°©ë‹¹ 2~3ê°œ, ê±°ì‹¤ 4~6ê°œ, ì£¼ë°© 3~4ê°œ ë° ì£¼ìš” ê°€ì „ ìœ„ì¹˜(ëƒ‰ì¥ê³ , ì„¸íƒê¸° ë“±)ë¥¼ ê³ ë ¤í•˜ì—¬ ë²½ë©´ ê¸¸ì´ì™€ ì‹¤ í‰ìˆ˜ì— ë¹„ë¡€í•´ ìœ ì¶” ì‚°ì •.
ì—ì½” ì˜¨ìŠ¤ ë‹¤ìš´ë¼ì´íŠ¸ 3ì¸ì¹˜ 8W / EA / ë³´ì¡° ì¡°ëª… ë° ë³µë„ë“± ì„¤ì¹˜ ê¸°í˜¸ ê°œìˆ˜ ê¸°ì¤€ ì‚°ì¶œ.
ëŒ€ë¦¼ ì£¼ë°© ìˆ˜ì „ DL-K2115SN ë‹ˆì¼ˆ ê¸°ë³¸ / EA / ì£¼ë°© ì‹±í¬ëŒ€ ìœ„ì¹˜ì— 1ê°œ ê¸°ë³¸ ì‚°ì •.
ì‚¬ê° ì–¸ë” ì‹±í¬ë³¼ ë°±ì¡° IS 530 ë°°ìˆ˜êµ¬ í¬í•¨ / ê°œ / ì£¼ë°© í•˜ë¶€ì¥ ì„¤ê³„ ë‚´ ì‹±í¬ë³¼ ìœ„ì¹˜ 1ê°œ ì‚°ì •.
ì¸ì¡°ëŒ€ë¦¬ì„ 12T UPE / M / ì£¼ë°© í•˜ë¶€ì¥ ìœ„ì— ì„¤ì¹˜ë  ìƒíŒì˜ ì´ ì§ì„  ê¸¸ì´(M).
í‚¤ì¹œ PET ìì¬ E0 ìƒí•˜ë¶€ì¥ / M / ì£¼ë°© ì‹±í¬ëŒ€ ìƒ/í•˜ë¶€ì¥ì˜ ì´ ê°€ë¡œ ê¸¸ì´(M).
ì„¸ë¼ì—í­ì‹œ / ê°œ / íƒ€ì¼ ì‹œê³µ ë©´ì (ã¡) ëŒ€ë¹„ ì œì¡°ì‚¬ ì†Œìš”ëŸ‰ í™˜ì‚° (í†µìƒ 5~7ã¡ë‹¹ 1ì„¸íŠ¸).
ì••ì°©ì‹œë©˜íŠ¸ ë°±ìƒ‰ / ê°œ / íƒ€ì¼ ì‹œê³µ ë©´ì (ã¡) ëŒ€ë¹„ ì œì¡°ì‚¬ ì†Œìš”ëŸ‰ í™˜ì‚° (í†µìƒ 5~7ã¡ë‹¹ 1í¬).
í¬ì„¸ë¦° íƒ€ì¼ IBIZA / BOX / (ì‹œê³µ ë©´ì  / 1.44) Ã— 1.1. 600ê° íƒ€ì¼ ê¸°ì¤€ 1ë°•ìŠ¤ 1.44ã¡ ì‹œê³µ ê°€ëŠ¥.
3. ê³µì‚¬ ë° ê¸°íƒ€ ë¹„ìš© í•­ëª© (Composite)
ê°€ì„¤ê³µì‚¬ / ì‹ / ì—˜ë¦¬ë² ì´í„° ë³´ì–‘ ë° í˜„ì¥ ì•ˆì „ ì‹œì„¤ ë“± ê³µì‚¬ ì¤€ë¹„ë¥¼ ìœ„í•œ 1íšŒì„± ë¹„ìš©.
ì–‘ì¤‘ë¹„ / ì‹ / ìì¬ ìƒí•˜ì°¨ ë° ì„¸ëŒ€ ë‚´ ìš´ë°˜ ì „ì²´ ë¹„ìš© 1ì‹ ì‚°ì •.
ì‚°ì—…ì¬í•´ë³´í—˜ / % / ì „ì²´ ì‚°ì¶œëœ ì¸ê±´ë¹„ í•©ê³„ì•¡ì˜ 1% ìë™ ì‚°ì •.
í˜„ì¥ê´€ë¦¬ë¹„ / % / (ì¸ê±´ë¹„ + ìì¬ë¹„ + ê³µì‚¬ë¹„) ì´ì•¡ì˜ 5%ë¥¼ í˜„ì¥ ìš´ì˜ ë¹„ìš©ìœ¼ë¡œ ì‚°ì •.
íƒ„ì„±ì½”íŠ¸ / ê°œì†Œ / í™•ì¥ ì œì™¸ ë°œì½”ë‹ˆ(ë² ë€ë‹¤)ì˜ ê°œë³„ ê³µê°„ ê°œìˆ˜.
ë§ˆê°ì‹¤ë¦¬ì½˜ / ì‹ / ê°€êµ¬, ì°½í˜¸, ëª°ë”© ë§ˆê° ë¶€ìœ„ì— ì‚¬ìš©ë  ì†Œëª¨í’ˆ ë° ì¸ê±´ë¹„ 1ì‹.
ì¤€ê³µì²­ì†Œ / ã¡ / ì•„íŒŒíŠ¸ ê³µê¸‰ ë©´ì (ë¶„ì–‘ í‰ìˆ˜) ì „ì²´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‚°ì •.
ì „ì²´ ì² ê±° / ã¡ / ë„ë©´ì˜ ì „ì²´ ë°”ë‹¥ ë©´ì (í™•ì¥ ì „ ë°œì½”ë‹ˆ í¬í•¨)ì„ ê¸°ì¤€ìœ¼ë¡œ ì‚°ì •.
íê¸°ë¬¼ ì²˜ë¦¬ / í†¤ / 10í‰ë‹¹ ì•½ 1~1.2í†¤ ë°œìƒ ê¸°ì¤€ (32í‰í˜• ì•½ 4í†¤ ì‚°ì •).
ë°œì½”ë‹ˆí™•ì¥ / ê°œì†Œ / ë„ë©´ìƒ 'í™•ì¥'ìœ¼ë¡œ í‘œê¸°ë˜ê±°ë‚˜ í™•ì¥ ì˜ˆì •ì¸ ê³µê°„ì˜ ê°œìˆ˜.
`;

// ====== ëŒ€í‘œ í•­ëª© ê¸°ë°˜ JSON ì‘ë‹µ í˜•ì‹ ìƒì„± ======
export function generateResponseFormat(representativeItems: {
    labor: LaborCost[];
    material: MaterialPrice[];
    composite: CompositeCost[];
}): string {
    const itemsList: string[] = [];

    // ë³µí•© ë¹„ìš©
    representativeItems.composite.forEach(c => {
        itemsList.push(`        "${c.id}": { "item": "${c.cost_name}", "unit": "${c.unit}", "quantity": ê³„ì‚°ëœìˆ˜ëŸ‰ }`);
    });

    // ìì¬
    representativeItems.material.forEach(m => {
        itemsList.push(`        "${m.id}": { "item": "${m.product_name}", "unit": "${m.unit}", "quantity": ê³„ì‚°ëœìˆ˜ëŸ‰ }`);
    });

    // ì¸ê±´ë¹„
    representativeItems.labor.forEach(l => {
        itemsList.push(`        "${l.id}": { "item": "${l.labor_type} ì¸ê±´ë¹„", "unit": "ì¼", "quantity": ê³„ì‚°ëœìˆ˜ëŸ‰ }`);
    });

    return `
# JSON ì‘ë‹µ í˜•ì‹ (ë°˜ë“œì‹œ ì´ í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µ)
{
    "floorplan": {
        "totalArea": ì „ìš©ë©´ì (ã¡),
        "sizeCategory": "30í‰ëŒ€|40í‰ëŒ€|50í‰ëŒ€|60í‰ëŒ€ ì´ìƒ",
        "rooms": [
            { "name": "ê³µê°„ëª…", "type": "bedroom|living|kitchen|bathroom|balcony|utility|hallway|other", "area": ë©´ì (ã¡) }
        ],
        "bedroomCount": ì¹¨ì‹¤ê°œìˆ˜,
        "bathroomCount": ìš•ì‹¤ê°œìˆ˜,
        "balconyCount": ë°œì½”ë‹ˆê°œìˆ˜,
        "floorArea": ë°”ë‹¥ë©´ì (ã¡),
        "wallArea": ë²½ë©´ì (ã¡),
        "ceilingArea": ì²œì¥ë©´ì (ã¡)
    },
    "quantities": {
${itemsList.join(',\n')}
    },
    "confidence": ì‹ ë¢°ë„(0-1),
    "notes": "ë¶„ì„ ì°¸ê³ ì‚¬í•­"
}

âš ï¸ ì¤‘ìš”:
- ë°˜ë“œì‹œ ìœ„ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µí•˜ì„¸ìš”
- quantitiesì˜ ê° í•­ëª© IDëŠ” ì •í™•íˆ ë§¤ì¹­ë˜ì–´ì•¼ í•©ë‹ˆë‹¤
- quantityê°€ 0ì´ë©´ í•´ë‹¹ í•­ëª© ì œì™¸
- ëª¨ë“  ìˆ«ìëŠ” ìˆ«ì íƒ€ì…ìœ¼ë¡œ ì¶œë ¥ (ë¬¸ìì—´ X)`;
}

// ====== ëŒ€í‘œ í•­ëª© ëª©ë¡ ìƒì„± ======
export function generateRepresentativeItemsContext(representativeItems: {
    labor: LaborCost[];
    material: MaterialPrice[];
    composite: CompositeCost[];
}): string {
    let context = `\n# ğŸ“‹ ê²¬ì  í•­ëª© ëª©ë¡ (ìˆ˜ëŸ‰ ê³„ì‚° í•„ìš”)\n`;
    context += `ì•„ë˜ í•­ëª©ë“¤ì— ëŒ€í•´ ë„ë©´ì„ ë¶„ì„í•˜ì—¬ ì ì ˆí•œ ìˆ˜ëŸ‰ì„ ê³„ì‚°í•´ì£¼ì„¸ìš”.\n\n`;

    // ì¹´í…Œê³ ë¦¬ë³„ ê·¸ë£¹í•‘
    const categoriesMap: Record<string, Array<{ id: string; name: string; unit: string; type: string }>> = {};

    // ë³µí•© ë¹„ìš©
    representativeItems.composite.forEach(c => {
        const cat = c.category || 'ê¸°íƒ€';
        if (!categoriesMap[cat]) categoriesMap[cat] = [];
        categoriesMap[cat].push({ id: c.id, name: c.cost_name, unit: c.unit, type: 'composite' });
    });

    // ìì¬
    representativeItems.material.forEach(m => {
        const cat = m.category || 'ê¸°íƒ€';
        if (!categoriesMap[cat]) categoriesMap[cat] = [];
        categoriesMap[cat].push({ id: m.id, name: m.product_name, unit: m.unit, type: 'material' });
    });

    // ì¸ê±´ë¹„
    representativeItems.labor.forEach(l => {
        const cat = 'ì¸ê±´ë¹„';
        if (!categoriesMap[cat]) categoriesMap[cat] = [];
        categoriesMap[cat].push({ id: l.id, name: `${l.labor_type} ì¸ê±´ë¹„`, unit: 'ì¼', type: 'labor' });
    });

    // ì¶œë ¥
    Object.entries(categoriesMap).forEach(([category, items]) => {
        context += `## ${category}\n`;
        items.forEach(item => {
            context += `- [${item.id}] ${item.name} (ë‹¨ìœ„: ${item.unit})\n`;
        });
        context += '\n';
    });

    return context;
}

// ====== ì „ì²´ í”„ë¡¬í”„íŠ¸ ì¡°í•© (ëŒ€í‘œ í•­ëª© ê¸°ë°˜) ======
export function buildFloorplanAnalysisPrompt(representativeItems: {
    labor: LaborCost[];
    material: MaterialPrice[];
    composite: CompositeCost[];
}): string {
    const totalItems = representativeItems.labor.length +
        representativeItems.material.length +
        representativeItems.composite.length;

    if (totalItems === 0) {
        throw new Error('ëŒ€í‘œ í•­ëª©(ê¸°ë³¸)ì´ ì—†ìŠµë‹ˆë‹¤. í‘œì¤€ë‹¨ê°€ ê´€ë¦¬ì—ì„œ ëŒ€í‘œ í•­ëª©ì„ ë¨¼ì € ì§€ì •í•´ì£¼ì„¸ìš”.');
    }

    let prompt = FLOORPLAN_ANALYSIS_SYSTEM_PROMPT;
    prompt += '\n\n' + QUANTITY_CALCULATION_RULES;
    prompt += generateRepresentativeItemsContext(representativeItems);
    prompt += generateResponseFormat(representativeItems);

    return prompt;
}

// ====== ê¸°ì¡´ í˜¸í™˜ì„±ì„ ìœ„í•œ ë ˆê±°ì‹œ í”„ë¡¬í”„íŠ¸ ======
export const FIXTURES_CALCULATION_RULES = QUANTITY_CALCULATION_RULES;

export const JSON_RESPONSE_FORMAT = `
# JSON ì‘ë‹µ í˜•ì‹ (ê¸°ë³¸)
{
    "totalArea": ì „ì²´ë©´ì (ã¡),
    "rooms": [
        { "name": "ê³µê°„ëª…", "type": "bedroom|living|kitchen|bathroom|balcony|utility|hallway|other", "width": ê°€ë¡œ(mm), "height": ì„¸ë¡œ(mm), "area": ë©´ì (ã¡) }
    ],
    "calculations": {
        "floorArea": ë°”ë‹¥ë©´ì (ã¡),
        "wallArea": ë²½ë©´ì (ã¡),
        "wallHeight": 2400,
        "ceilingArea": ì²œì¥ë©´ì (ã¡)
    },
    "fixtures": {
        "toilet": ì–‘ë³€ê¸°ê°œìˆ˜,
        "sink": ì„¸ë©´ê¸°ê°œìˆ˜,
        "bathroomFaucet": ìš•ì‹¤ìˆ˜ì „ê°œìˆ˜,
        "kitchenFaucet": ì£¼ë°©ìˆ˜ì „ê°œìˆ˜,
        "showerSet": ìƒ¤ì›Œê¸°ì„¸íŠ¸ê°œìˆ˜
    },
    "confidence": ì‹ ë¢°ë„(0-1),
    "analysisNotes": "ë¶„ì„ ì°¸ê³ ì‚¬í•­"
}`;

// ê¸°ì¡´ generatePricingContext í•¨ìˆ˜ (í˜¸í™˜ì„± ìœ ì§€)
export function generatePricingContext(pricingData: {
    labor: Array<{ labor_type: string; daily_rate: number; description?: string }>;
    material: Array<{ category: string; sub_category?: string; product_name: string; unit: string }>;
    composite: Array<{ cost_name: string; category: string; unit: string }>;
}): string {
    // ê¸°ì¡´ ë°©ì‹ - ë‹¨ìˆœ ì»¨í…ìŠ¤íŠ¸ ìƒì„±
    const { labor, material, composite } = pricingData;

    let context = `\n# ì°¸ê³ : ì¸í…Œë¦¬ì–´ ê³µì • í•­ëª© ëª©ë¡\n`;

    const categories = new Set([
        ...material.map(m => m.category),
        ...composite.map(c => c.category)
    ]);

    categories.forEach(category => {
        context += `## ${category}\n`;
        const categoryMaterials = material.filter(m => m.category === category);
        categoryMaterials.slice(0, 5).forEach(m => {
            context += `- ${m.product_name} (${m.unit})\n`;
        });
        const categoryCosts = composite.filter(c => c.category === category);
        categoryCosts.slice(0, 3).forEach(c => {
            context += `- ${c.cost_name} (${c.unit})\n`;
        });
        context += '\n';
    });

    if (labor.length > 0) {
        context += `## ì¸ê±´ë¹„ ì¢…ë¥˜\n`;
        labor.forEach(l => {
            context += `- ${l.labor_type}\n`;
        });
    }

    return context;
}
